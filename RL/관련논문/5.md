# 제목 

- [TinyFed: Lightweight Federated Learning for Constrained IoT Devices](https://onlinelibrary.wiley.com/doi/full/10.1002/itl2.70061)

# 저자

- Claudio Jr. N. da Silva, Maycon L. M. Peixoto, Gustavo B. Figueiredo, Cassio V. S. Prazeres

# Abstract

-  자원이 제한된 IoT기기를 위한 경량 연합학습(TinyFL) 프레임워크인 TinyFed 연구 
-  ESP32(저가형 마이크로 컨트롤러)에서 4개의 입력(온도, 습도, 밝기, 전압)을 받아 3개의 은닉층(16, 8, 4 neurons each)으로 학습하고 2개의 출력(이상 탐지 여부)하는 경량 TinyFL인 TinyFed를 제안하고 구현
-  즉, 4개의 센서 데이터를 기반으로 이상(anomaly)을 탐지하는 경량형 신경망 연합 학습 프레임워크 제안.
-  정확도(Accuracy) 기준 최대 99.47%까지 달성 => 저사양 기기에서도 충분히 높은 성능을 낼 수 있음을 입증함.

# Keywords:

- constrained devices, IoT, machine learning, neural networks, TinyFL 

# 용어 정리

|용어|설명|
|:-|:-|
|TinyML|아주 작은 마이크로 컨트롤러(저전력, 저메모리 장치)에서도 머신러닝 모델을 실행할 수 있게 하는 기술. 예:센서가 달린 작은 IoT 기기에서 데이터를 바로 분석|
|Tiny Federated Learning(TinyFL)|여러 개의 작은 IoT 기기들이 각자 데이터를 학습하고, 그 결과(모델 파라미터)만 중앙 서버에 공유해서 전체 모델을 개선하는 방식. 데이터를 직접 모으지 않고도 협력 학습이 가능해 개인정보 보호와 통신 효율성을 높임|
|TinyFed|이 논문에서 제안한 새로운 프레임워크. <br>- TinyFL을 실제로 구현해서 "학습-> 모델 집계 -> 재배포" 까지의 전 과정을 지원하는 경량 시스템을 TinyFed라 칭함.|


# 실험 방법

- 장치 및 네트워크: 3개의 ESP32 마이크로 컨트롤러를 Wi-Fi에 연결하고, 노트북(i7, 16GRAM, Linux, 256GB SDD)을 집계 서버 및 MQTT 서버로 사용
- 개발 도구 및 라이브러리:
  - 개발 도구: Arduino IDE
  - 로컬 데이터 라이브러리: FS.h
  - 가중치 저장용 라이브러리: SPIFFS.h
- 센서 구성: 각 ESP32에 DHT22 센서 연결(온도, 습도 데이터 수집), 밝기와 전압 데이터는 랜덤 생성값으로 더해서 입력 데이터로 구성
- 데이터 저장 및 포맷: 각 장치는 수집 데이터를 CSV로 로컬 저장하여 로컬 학습에 사용
- 로컬 학습 라운드(t)가 끝날 때마다 각 장치는 업데이트된 가중치를 MQTT 서버에 전송
- 집계 알고리즘: 서버는 FedAvg 전략을 적용해 모든 장치의 가중치 평균을 계산하여 글로벌 파라미터(가중치)를 얻음
- 재배포: 집계된 글로벌 가중치를 다시 각 ESP32로 배포하여 다음 라운드 학습과 추론에 반영
- 라운드 구서: 실험에서는 장치별  25 라운드의 로컬 학습과 집계 과정을 수행함
- 메모리 사용량: 학습 중 free HEAP memory를 모니터링했으며, 메모리 누수 없이 156.63 ~ 160.75 KB 범위에서 안정적으로 동작함.
- 시간 및 에너지 고려: 샘플 수 증가가 학습 시간과 에너지에 직접 영향을 미치므로, 뉴런 푸루닝 등 경량화 전략 고려
- 통신 비용: TinyFed는 가중치만 전송하여 대역폭을 절감하고 지연을 낮추는 방향으로 통신 비용 최소화 지향

# 실험 결과

<img width="631" height="254" alt="image" src="https://github.com/user-attachments/assets/7384b57b-258f-4730-a86c-f6fb728766a8" />
